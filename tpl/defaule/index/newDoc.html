{extend name="defaule/public/main_edit"}{block name="main"}
<div class="mdui-container mdui-m-t-2">
    <div class="mdui-row">
        <div class="mdui-col-xs-12">
            <form action="">
                <textarea name="content" id="editor" cols="30" rows="10"></textarea>
                <div class="mdui-dialog" id="exampleDialog">
                    <div class="mdui-dialog-title">填写一些信息，马上完成！</div>
                    <div class="mdui-dialog-content">
                        <div class="mdui-textfield">
                            <label class="mdui-textfield-label">文档标题</label>
                            <input class="mdui-textfield-input" required type="text" name="name" />
                        </div>
                        <div class="mdui-textfield">
                            <label class="mdui-textfield-label">文档标识</label>
                            <input class="mdui-textfield-input" required type="text" name="sign" />
                        </div>
                        <div class="mdui-textfield">
                            <label class="mdui-textfield-label">上一级文档</label>
                            <input class="mdui-textfield-input" type="text" name="father" />
                        </div>
                        <h4>可见性</h4>
                        <label class="mdui-radio">
                            <input type="radio" name="type" checked/>
                            <i class="mdui-radio-icon"></i>公开
                        </label>
                        <br>
                        <label class="mdui-radio">
                            <input type="radio" name="type" />
                            <i class="mdui-radio-icon"></i>私有
                        </label>
                    </div>
                    <div class="mdui-dialog-actions">
                        <button class="mdui-btn mdui-ripple" type="button" mdui-dialog-close>取消</button>
                        <button class="mdui-btn mdui-ripple" type="button" mdui-dialog-confirm id="submit">发布</button>
                    </div>
                </div>
            </form>
            <button class="mdui-btn mdui-ripple mdui-color-theme-accent" mdui-dialog="{target: '#exampleDialog'}">发布</button>
        </div>
    </div>
</div>
{/block} {block name="js"}
<link rel="stylesheet" href="__EDITOR__simplemde.min.css">
<style>
    .CodeMirror {
        height: 400px;
    }
</style>
<script src="__EDITOR__simplemde.min.js"></script>
<script>
    let $$ = mdui.JQ;
    new SimpleMDE({
        element: document.getElementById("editor"),
        spellChecker: false,
        autofocus: true,
        autosave: {
            enabled: true,
            uniqueId: "MLTFEditor",
            delay: 1000,
        },
        placeholder: "请开始你的创作吧~",
        prompturls: true,
        renderingConfig: {
            singleLineBreaks: false,
            codeSyntaxHighlighting: true,
        },
        toolbar: ["bold", "italic", "heading", "|", "code", "quote", "unordered-list", "ordered-list", "clean-block", "|", "link", "image", "|", "table", "horizontal-rule", "|", "preview", "side-by-side", "|", "fullscreen", "guide"],
    })

    $$('#submit').on('click', function() {
        let data = $$('form').serialize();
        console.log(data);

        $$.ajax({
            method: 'POST',
            url: '',
            data: data,
            dataType: 'json',
            success: function(res) {
                if (res.code == 0) {
                    mdui.snackbar('发布成功', {
                        timeout: 3000,
                        position: 'top',
                    })
                }
            }
        });
        return false;
    })
</script>
{/block}